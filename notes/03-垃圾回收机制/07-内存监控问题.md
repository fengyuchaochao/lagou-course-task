# 内存问题


## 内存问题的外在体现

* 页面出现延迟加载或者经常性暂停，那说明很有可能因为频繁的垃圾回收
* 在多数设备上存在性能问题，那说明可能存在内存膨胀，所谓内存膨胀其实就是我们应用运行所需要的内存，比当前设备的实际能提供的内存大很多，导致其无法在这些设备上进行运行。
* 页面性能随着时间的延长越来越差，那说明在使用过程中，可能存在内存泄漏的问题，导致内存占用持续升高

## 监控内存的几种方式

从上上面，我们知道了：内存问题主要包含下面三种情况：
* 频繁的垃圾回收：通过内存变化图进行分析
* 内存膨胀：在多数设备上存在性能问题（可能是设备问题，不是程序问题）
* 内存泄漏：内存使用持续升高（程序本身问题）

那具体如何去监控内存呢？

* 浏览器任务管理器
* Timeline时序图记录
* 堆块照查找分离DOM


#### 一. 浏览器任务管理器

![image](http://note.youdao.com/yws/res/10113/CABD929D1AEA45B1AE6862CF09AA44B0)

我们可以通过红块中的大小变化，来判断当前tab页的javascript代码运行过程中所占用的内存大小。

但是这种方法，更多的只是让我们知道当前tab页的js脚本确实可能存在问题导致内存突然增大，但是具体是什么原因却无法判断。


#### 二. Timeline时序图

![image](http://note.youdao.com/yws/res/10122/5E1BA9B80F4541E88FE62A360E022D9F)

即还是通过Performance-> JS Heap 去监控一段时间内，页面内存的变化情况，通过这种方式，我们可以更清楚的了解是在哪个时间点，进行了哪些操作导致的内存突然增大。


#### 三. 堆块照查找分离DOM




#### 四. 判断是否存在频繁GC

首先，要知道为什么要确定频繁GC，频繁GC有什么影响？

因为GC工作时，当前应用程序是停止执行的，所以频繁且过长的GC会导致当前应用程序假死，对于用户而言，感知到的效果就是页面的卡顿。


那具体如何判断是否存在频繁GC呢？

* 通过timeline时序图，如果频繁GC的话，时序图会频繁瞬间上升下降。
* 通过任务管理器，也可以看到数据频繁增大或者减少，也说明存在频繁GC。

